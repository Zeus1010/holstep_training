N Reduction4.flatten_filter
C |- (!s. (!f. ((flatten ((MAP (filter f)) s)) = ((filter f) (flatten s)))))
T c= cflatten cMAP * part cfilter f0 f1 cfilter f0 cflatten f1
D TRUTH
A |- T
T cT
D list_INDUCT
A |- (!P. (((P NIL) /\ (!a0. (!a1. ((P a1) ==> (P ((CONS a0) a1)))))) ==> (!x. (P x))))
T c==> c/\ * f0 cNIL ! ! c==> * f0 b1 * f0 cCONS b0 b1 ! * f0 b0
D MAP
A |- ((!f. (((MAP f) NIL) = NIL)) /\ (!f. (!h. (!t. (((MAP f) ((CONS h) t)) = ((CONS (f h)) ((MAP f) t)))))))
T c/\ ! c= cMAP b0 cNIL cNIL ! ! ! c= cMAP b0 cCONS b1 b2 cCONS * b0 b1 cMAP b0 b2
D Seq.filter
A |- (!a. (!x. (!s'. ((((filter a) NIL) = NIL) /\ (((filter a) ((CONS x) s')) = (((COND (a x)) ((CONS x) ((filter a) s'))) ((filter a) s')))))))
T c/\ c= cfilter f0 cNIL cNIL c= cfilter f0 cCONS f1 f2 cCOND * f0 f1 cCONS f1 cfilter f0 f2 cfilter f0 f2
D Seq.filter_cat
A |- (!a. (!s1. (!s2. (((filter a) ((cat s1) s2)) = ((cat ((filter a) s1)) ((filter a) s2))))))
T c= cfilter f0 ccat f1 f2 ccat cfilter f0 f1 cfilter f0 f2
D Seq.flatten0
A |- ((flatten NIL) = NIL)
T c= cflatten cNIL cNIL
D Seq.flatten_cons
A |- (!s. (!ss. ((flatten ((CONS s) ss)) = ((cat s) (flatten ss)))))
T c= cflatten cCONS f0 f1 ccat f0 cflatten f1
+ |- (((!a. (!x. (!s'. ((((filter a) NIL) = NIL) /\ (((filter a) ((CONS x) s')) = (((COND (a x)) ((CONS x) ((filter a) s'))) ((filter a) s'))))))) ==> ((\a. (!x. (!s'. ((((filter a) NIL) = NIL) /\ (((filter a) ((CONS x) s')) = (((COND (a x)) ((CONS x) ((filter a) s'))) ((filter a) s'))))))) a)) = ((\a. (!x. (!s'. ((((filter a) NIL) = NIL) /\ (((filter a) ((CONS x) s')) = (((COND (a x)) ((CONS x) ((filter a) s'))) ((filter a) s'))))))) a))
T c= c==> ! ! ! c/\ c= cfilter b0 cNIL cNIL c= cfilter b0 cCONS b1 b2 cCOND * b0 b1 cCONS b1 cfilter b0 b2 cfilter b0 b2 * / ! ! c/\ c= cfilter b0 cNIL cNIL c= cfilter b0 cCONS b1 b2 cCOND * b0 b1 cCONS b1 cfilter b0 b2 cfilter b0 b2 f0 * / ! ! c/\ c= cfilter b0 cNIL cNIL c= cfilter b0 cCONS b1 b2 cCOND * b0 b1 cCONS b1 cfilter b0 b2 cfilter b0 b2 f0
+ |- (((!f. (!h. (!t. (((MAP f) ((CONS h) t)) = ((CONS (f h)) ((MAP f) t)))))) ==> ((\f. (!h. (!t. (((MAP f) ((CONS h) t)) = ((CONS (f h)) ((MAP f) t)))))) f)) = ((\f. (!h. (!t. (((MAP f) ((CONS h) t)) = ((CONS (f h)) ((MAP f) t)))))) f))
T c= c==> ! ! ! c= cMAP b0 cCONS b1 b2 cCONS * b0 b1 cMAP b0 b2 * / ! ! c= cMAP b0 cCONS b1 b2 cCONS * b0 b1 cMAP b0 b2 f0 * / ! ! c= cMAP b0 cCONS b1 b2 cCONS * b0 b1 cMAP b0 b2 f0
- |- (((!l. ((((MAP f) l) = NIL) = (l = NIL))) ==> ((\l. ((((MAP f) l) = NIL) = (l = NIL))) l)) = ((\l. ((((MAP f) l) = NIL) = (l = NIL))) l))
T c= c==> ! c= c= cMAP f0 b0 cNIL c= b0 cNIL * / c= c= cMAP f0 b0 cNIL c= b0 cNIL f1 * / c= c= cMAP f0 b0 cNIL c= b0 cNIL f1
+ |- (((!f. ((flatten ((MAP (filter f)) t)) = ((filter f) (flatten t)))) ==> (!f. ((flatten ((MAP (filter f)) ((CONS h) t))) = ((filter f) (flatten ((CONS h) t)))))) = T)
T c= c==> ! c= cflatten cMAP * part cfilter b0 f0 cfilter b0 cflatten f0 ! c= cflatten cMAP * part cfilter b0 cCONS f1 f0 cfilter b0 cflatten cCONS f1 f0 cT
+ |- (((!a. (!s1. (!s2. (((filter a) ((cat s1) s2)) = ((cat ((filter a) s1)) ((filter a) s2)))))) ==> ((\a. (!s1. (!s2. (((filter a) ((cat s1) s2)) = ((cat ((filter a) s1)) ((filter a) s2)))))) a)) = ((\a. (!s1. (!s2. (((filter a) ((cat s1) s2)) = ((cat ((filter a) s1)) ((filter a) s2)))))) a))
T c= c==> ! ! ! c= cfilter b0 ccat b1 b2 ccat cfilter b0 b1 cfilter b0 b2 * / ! ! c= cfilter b0 ccat b1 b2 ccat cfilter b0 b1 cfilter b0 b2 f0 * / ! ! c= cfilter b0 ccat b1 b2 ccat cfilter b0 b1 cfilter b0 b2 f0
+ (!f. ((flatten ((MAP (filter f)) t)) = ((filter f) (flatten t)))) |- ((\f. ((flatten ((MAP (filter f)) t)) = ((filter f) (flatten t)))) f)
T c==> ! c= cflatten cMAP * part cfilter b0 f0 cfilter b0 cflatten f0 * / c= cflatten cMAP * part cfilter b0 f0 cfilter b0 cflatten f0 f1
+ |- ((!f. t) = t)
T c= ! f0 f0
- |- (((filter a) ((CONS x) s')) = (((COND (a x)) ((CONS x) ((filter a) s'))) ((filter a) s')))
T c= cfilter f0 cCONS f1 f2 cCOND * f0 f1 cCONS f1 cfilter f0 f2 cfilter f0 f2
- |- ((\f. (!l. ((((MAP f) l) = NIL) = (l = NIL)))) f)
T * / ! c= c= cMAP b0 b1 cNIL c= b1 cNIL f0
- |- ((((MAP f) l) = NIL) = (l = NIL))
T c= c= cMAP f0 f1 cNIL c= f1 cNIL
- |- ((\l. ((((MAP f) l) = NIL) = (l = NIL))) l)
T * / c= c= cMAP f0 b0 cNIL c= b0 cNIL f1
- |- (((!f. (!l. ((((MAP f) l) = NIL) = (l = NIL)))) ==> ((\f. (!l. ((((MAP f) l) = NIL) = (l = NIL)))) f)) = ((\f. (!l. ((((MAP f) l) = NIL) = (l = NIL)))) f))
T c= c==> ! ! c= c= cMAP b0 b1 cNIL c= b1 cNIL * / ! c= c= cMAP b0 b1 cNIL c= b1 cNIL f0 * / ! c= c= cMAP b0 b1 cNIL c= b1 cNIL f0
